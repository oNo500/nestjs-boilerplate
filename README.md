## 架构思想

## 1. 洋葱模型与DDD的核心思想

洋葱模型：强调“依赖规则”，即越核心的层（如领域模型）不依赖外层，外层依赖内层。通常分为：
Domain（领域层）：实体、聚合、领域服务
Application（应用层）：用例、流程编排
Infrastructure（基础设施层）：数据库、第三方服务、框架集成
Interface（接口层）：API、UI、外部适配器
DDD：强调以领域为中心，分为领域层、应用层、基础设施层、接口层，鼓励将通用能力和领域能力分离。

## 2. 分层架构

```markdown
src/
├── core/ # 核心能力（如日志、守卫、装饰器、限流等，偏基础设施/技术层）
├── shared/ # 可复用的通用模块（如认证、健康检查、工具、事件、定时任务等）
├── features/ # 业务功能模块（如用户模块，偏领域/应用层）
├── database/ # 数据库相关（schema、migrations，偏基础设施层）
├── config/ # 配置
```

features/：对应 DDD 的领域层和应用层，每个子目录可视为一个“限界上下文”。
core/：偏向基础设施层，提供全局技术能力（如日志、守卫、装饰器等），不直接承载业务逻辑。
shared/：介于基础设施层和领域服务层之间，提供可复用的通用能力（如认证、健康检查、工具等），有些内容可能属于“领域服务”，有些属于“通用基础设施”。
database/：纯粹的基础设施层，负责数据持久化。
config/：配置管理，属于基础设施支撑。

**core 与 shared 的边界分析**

